#! /usr/bin/env coffee

notice = require '../../lib/notice'

TelevisionRemote = notice.client(

    capsules: 

        channel: {}
        volume:  {}
        pause:   {}
        play:    {}
        ffwd:    {}

).create "Television Remote #{process.env.NAME}",

    context: 
        supremeAuthority: 'Mother' unless Grandfather? or Saturday?
        batteryLevel: 4 / 9

    connect: 
        adaptor:            'socket.io'
        url:                'https://localhost:10101'
        secret:             process.env.SECRET
        errorWait:          1000
        rejectUnauthorized: false # tolerate self sighned cert on serverside


    (error, theRemote) -> 

        #
        # callback receives connected theRemote as a notifier,
        # or error
        #

        return console.log error if error?

        theRemote.volume up: 3, (err, capsule) -> 
    
            return console.log 'ERROR', err if err?
            console.log capsule.all
            # console.log capsule



        # client.volume( 'up', amount: 3 ).then(

        #     (capsule) -> console.log AFTER_ACK: capsule
        #     (error)   -> console.log ERROR: error
        #     (notify)  -> console.log NOTIFY: notify 

        # )

